---
title: "Myanmanr Farming Survey - Second Cut"
output:
  html_document:
    css: custom.css
    toc: yes
tables: yes    
---


```{r setup, echo = FALSE, warning = FALSE, message = FALSE}
library(dplyr)
library(xtable)
library(knitr)
library(RColorBrewer)
load("../data/survey.dataframe.RData")

library(memisc)
load("../data/survey.dataset.RData")

## merge together three tables - age, region and land ownership.
## also drop categories that don't have any cases 
FunR02Table <- function(var) {
  x <-  cbind(table(var ,data$n151 ),
              table(var ,data$n152 ),
              table(var ,data$n153 ))
  row_sub = apply(x, 1, function(row) !all(row == 0 ))
  x <- x[row_sub,]
  prop.table(x, 2)*100
}


y <-  c(table(data$n151 ),
            table(data$n152 ),
            table(data$n153 ))
```

# Gender-Age-Education-Civil-Status-Health

## `r description(I(dataset$q1))`

```{r results='asis', echo=FALSE, fig.height=6}
var <- data$q1
kable(FunR02Table(var), digits = 2, booktabs = TRUE, padding = 10)
par(mar = c(10,2,1,1), xpd = TRUE)
barplot(FunR02Table(var), width = y, space = c(.5,.5,1,.5,1,.5,.5),
        col = colorRampPalette(brewer.pal(11, "Spectral"))(length(unique(var))),
        legend.text = rownames(FunR02Table(var)), args.legend = list(y = -15))

```


## `r description(I(dataset$n154))`

```{r results='asis', echo=FALSE, fig.height=6}
var <- data$n154
kable(FunR02Table(var), digits = 2, booktabs = TRUE, padding = 10)
par(mar = c(10,2,1,1), xpd = TRUE)
barplot(FunR02Table(var), width = y, space = c(.5,.5,1,.5,1,.5,.5),
        col = colorRampPalette(brewer.pal(11, "Spectral"))(length(unique(var))),
        legend.text = rownames(FunR02Table(var)), args.legend = list(y = -15))

```

## `r description(I(dataset$q3))`

```{r results='asis', echo=FALSE, fig.height=6}
var <- data$q3
kable(FunR02Table(var), digits = 2, booktabs = TRUE, padding = 10)
par(mar = c(10,2,1,1), xpd = TRUE)
barplot(FunR02Table(var), width = y, space = c(.5,.5,1,.5,1,.5,.5),
        col = colorRampPalette(brewer.pal(11, "Spectral"))(length(unique(var))),
        legend.text = rownames(FunR02Table(var)), args.legend = list(y = -15))

```

## `r description(I(dataset$q4))`

```{r results='asis', echo=FALSE, fig.height=6}
var <- data$q4
kable(FunR02Table(var), digits = 2, booktabs = TRUE, padding = 10)
par(mar = c(10,2,1,1), xpd = TRUE)
barplot(FunR02Table(var), width = y, space = c(.5,.5,1,.5,1,.5,.5),
        col = colorRampPalette(brewer.pal(11, "Spectral"))(nrow(FunR02Table(var))),
        legend.text = rownames(FunR02Table(var)), args.legend = list(y = -15))

```

## `r description(I(dataset$q5))`

```{r results='asis', echo=FALSE, fig.height=6}
var <- data$q5
kable(FunR02Table(var), digits = 2, booktabs = TRUE, padding = 10)
par(mar = c(10,2,1,1), xpd = TRUE)
barplot(FunR02Table(var), width = y, space = c(.5,.5,1,.5,1,.5,.5),
        col = colorRampPalette(brewer.pal(11, "Spectral"))(nrow(FunR02Table(var))),
        legend.text = rownames(FunR02Table(var)), args.legend = list(y = -15))

```



## `r description(I(dataset$q6_a))`

```{r results='asis', echo=FALSE, fig.height=6}
var <- data$q6_a
kable(FunR02Table(var), digits = 2, booktabs = TRUE, padding = 10)
par(mar = c(10,2,1,1), xpd = TRUE)
barplot(FunR02Table(var), width = y, space = c(.5,.5,1,.5,1,.5,.5),
        col = colorRampPalette(brewer.pal(11, "Spectral"))(nrow(FunR02Table(var))),
        legend.text = rownames(FunR02Table(var)), args.legend = list(y = -15))
```
## `r description(I(dataset$q6_b))`

```{r results='asis', echo=FALSE, fig.height=6}
var <- data$q6_b
kable(FunR02Table(var), digits = 2, booktabs = TRUE, padding = 10)
par(mar = c(10,2,1,1), xpd = TRUE)
barplot(FunR02Table(var), width = y, space = c(.5,.5,1,.5,1,.5,.5),
        col = colorRampPalette(brewer.pal(11, "Spectral"))(nrow(FunR02Table(var))),
        legend.text = rownames(FunR02Table(var)), args.legend = list(y = -15))
```

## `r description(I(dataset$q6_c))`

```{r results='asis', echo=FALSE, fig.height=6}
var <- data$q6_c
kable(FunR02Table(var), digits = 2, booktabs = TRUE, padding = 10)
par(mar = c(10,2,1,1), xpd = TRUE)
barplot(FunR02Table(var), width = y, space = c(.5,.5,1,.5,1,.5,.5),
        col = colorRampPalette(brewer.pal(11, "Spectral"))(nrow(FunR02Table(var))),
        legend.text = rownames(FunR02Table(var)), args.legend = list(y = -15))
```

## `r description(I(dataset$q6_d))`

```{r results='asis', echo=FALSE, fig.height=6}
var <- data$q6_d
kable(FunR02Table(var), digits = 2, booktabs = TRUE, padding = 10)
par(mar = c(10,2,1,1), xpd = TRUE)
barplot(FunR02Table(var), width = y, space = c(.5,.5,1,.5,1,.5,.5),
        col = colorRampPalette(brewer.pal(11, "Spectral"))(nrow(FunR02Table(var))),
        legend.text = rownames(FunR02Table(var)), args.legend = list(y = -15))
```

## `r description(I(dataset$q6_e))`

```{r results='asis', echo=FALSE, fig.height=6}
var <- data$q6_e
kable(FunR02Table(var), digits = 2, booktabs = TRUE, padding = 10)
par(mar = c(10,2,1,1), xpd = TRUE)
barplot(FunR02Table(var), width = y, space = c(.5,.5,1,.5,1,.5,.5),
        col = colorRampPalette(brewer.pal(11, "Spectral"))(nrow(FunR02Table(var))),
        legend.text = rownames(FunR02Table(var)), args.legend = list(y = -15))
```

## `r description(I(dataset$q6_f))`

```{r results='asis', echo=FALSE, fig.height=6}
var <- data$q6_f
kable(FunR02Table(var), digits = 2, booktabs = TRUE, padding = 10)
par(mar = c(10,2,1,1), xpd = TRUE)
barplot(FunR02Table(var), width = y, space = c(.5,.5,1,.5,1,.5,.5),
        col = colorRampPalette(brewer.pal(11, "Spectral"))(nrow(FunR02Table(var))),
        legend.text = rownames(FunR02Table(var)), args.legend = list(y = -15))
```

## `r description(I(dataset$q6_g))`

```{r results='asis', echo=FALSE, fig.height=6}
var <- data$q6_g
kable(FunR02Table(var), digits = 2, booktabs = TRUE, padding = 10)
par(mar = c(10,2,1,1), xpd = TRUE)
barplot(FunR02Table(var), width = y, space = c(.5,.5,1,.5,1,.5,.5),
        col = colorRampPalette(brewer.pal(11, "Spectral"))(nrow(FunR02Table(var))),
        legend.text = rownames(FunR02Table(var)), args.legend = list(y = -15))
```

## `r description(I(dataset$q6_h))`

```{r results='asis', echo=FALSE, fig.height=6}
var <- data$q6_h
kable(FunR02Table(var), digits = 2, booktabs = TRUE, padding = 10)
par(mar = c(10,2,1,1), xpd = TRUE)
barplot(FunR02Table(var), width = y, space = c(.5,.5,1,.5,1,.5,.5),
        col = colorRampPalette(brewer.pal(11, "Spectral"))(nrow(FunR02Table(var))),
        legend.text = rownames(FunR02Table(var)), args.legend = list(y = -15))
```

## `r description(I(dataset$n1))`

```{r results='asis', echo=FALSE, fig.height=6}
var <- data$n1
kable(FunR02Table(var), digits = 2, booktabs = TRUE, padding = 10)
par(mar = c(10,2,1,1), xpd = TRUE)
barplot(FunR02Table(var), width = y, space = c(.5,.5,1,.5,1,.5,.5),
        col = colorRampPalette(brewer.pal(11, "Spectral"))(nrow(FunR02Table(var))),
        legend.text = rownames(FunR02Table(var)), args.legend = list(y = -15))

```
